{
  "@context": [
    {
      "sdtl": "https://rdf-vocabulary.ddialliance.org/sdtl#"
    },
    {
      "run": "http://wholetale.org/run/sdtl/"
    }

  ],
  "@graph": [
    {
      "@id": "run:program/1",
      "@type": "sdtl:Program",
      "sdtl:Commands": [
        {
          "@id": "run:load/1",
          "@type": "sdtl:Load",
          "sdtl:FileName": "df.csv",
          "sdtl:FileFormat": "csv",
          "stdl:ProducesDataframe": {
            "@id": "run:dataframe/1",
            "@type": "sdtl:DataframeDescription",
            "sdtl:DataframeName": "df",
            "sdtl:VariableInventory": ["A", "B"]
          },
          "sdtl:SourceInformation": {
              "@id": "run:sourceinfo/1",
              "@type": "sdtl:SourceInformation",
              "sdtl:originalSourceText": "df = pd.read_csv('../data/df.csv')"
          }
        },
        {
          "@id": "run:compute/1",
          "@type": "sdtl:Compute",
          "stdl:ConsumesDataframe": {"@id": "run:dataframe/1"},
          "stdl:Variable": {
            "@id": "run:variable/1",
            "@type": "stdl:VariableSymbolExpression",
            "stdl:VariableName": "A"
          },
          "stdl:ProducesDataframe": {
            "@id": "run:dataframe/2",
            "@type": "sdtl:DataframeDescription",
            "sdtl:DataframeName": "df",
            "sdtl:VariableInventory": ["A", "B"]
          },
          "sdtl:SourceInformation": {
              "@id": "run:sourceinfo/2",
              "@type": "sdtl:SourceInformation",
              "sdtl:originalSourceText": "df['A'] = 3"
          }
        },
        {
          "@id": "run:compute/2",
          "@type": "sdtl:Compute",
          "stdl:ConsumesDataframe": {"@id": "run:dataframe/2"},
          "stdl:Variable": {
            "@id": "run:variable/2",
            "@type": "stdl:VariableSymbolExpression",
            "stdl:VariableName": "B"
          },
          "stdl:ProducesDataframe": {
            "@id": "run:dataframe/3",
            "@type": "sdtl:DataframeDescription",
            "sdtl:DataframeName": "df",
            "sdtl:VariableInventory": ["A", "B"]
          },
          "sdtl:SourceInformation": {
              "@id": "run:sourceinfo/3",
              "@type": "sdtl:SourceInformation",
              "sdtl:originalSourceText": "df['B'] = df.B + 6.5"
          }
        },
        {
          "@id": "run:compute/3",
          "@type": "sdtl:Compute",
          "stdl:ConsumesDataframe": {"@id": "run:dataframe/3"},
          "stdl:Variable": {
            "@id": "run:variable/3",
            "@type": "stdl:VariableSymbolExpression",
            "stdl:VariableName": "C"
          },
          "stdl:ProducesDataframe":     {
            "@id": "run:dataframe/4",
            "@type": "sdtl:DataframeDescription",
            "sdtl:DataframeName": "df",
            "sdtl:VariableInventory": ["A", "B", "C"]
          },
          "sdtl:SourceInformation": {
              "@id": "run:sourceinfo/4",
              "@type": "sdtl:SourceInformation",
              "sdtl:originalSourceText": "df['C'] = df.A - df.B"
          }
        },
        {
          "@id": "run:load/2",
          "@type": "sdtl:Load",
          "sdtl:FileName": "temps.csv",
          "sdtl:FileFormat": "csv",
          "stdl:ProducesDataframe": {
            "@id": "run:dataframe/5",
            "@type": "sdtl:DataframeDescription",
            "sdtl:DataframeName": "temps",
            "sdtl:VariableInventory": ["Fahrenheit"]
          },
          "sdtl:SourceInformation": {
            "@id": "run:sourceinfo/5",
            "@type": "sdtl:SourceInformation",
            "sdtl:originalSourceText": "temps = pd.read_csv('../data/temps.csv')"
        }
      },
        {
          "@id": "run:compute/4",
          "@type": "sdtl:Compute",
          "stdl:ConsumesDataframe": {"@id": "run:dataframe/5"},
          "stdl:Variable": {
            "@id": "run:variable/4",
            "@type": "stdl:VariableSymbolExpression",
            "stdl:VariableName": "Celsius"
          },
          "stdl:ProducesDataframe": {
            "@id": "run:dataframe/6",
            "@type": "sdtl:DataframeDescription",
            "sdtl:DataframeName": "temps",
            "sdtl:VariableInventory": ["Fahrenheit", "Celsius"]
          },
          "sdtl:SourceInformation": {
              "@id": "run:sourceinfo/6",
              "@type": "sdtl:SourceInformation",
              "sdtl:originalSourceText": "temps = temps.assign(Celsius=((temps.Fahrenheit - 32) * 5 / 9))"
          }
        },
        {
          "@id": "run:compute/5",
          "@type": "sdtl:Compute",
          "stdl:ConsumesDataframe": {"@id": "run:dataframe/6"},
          "stdl:Variable": {
            "@id": "run:variable/5",
            "@type": "stdl:VariableSymbolExpression",
            "stdl:VariableName": "Kelvin"
          },
          "stdl:ProducesDataframe":  {
            "@id": "run:dataframe/7",
            "@type": "sdtl:DataframeDescription",
            "sdtl:DataframeName": "temps",
            "sdtl:VariableInventory": ["Fahrenheit", "Celsius", "Kelvin"]
          },
          "sdtl:SourceInformation": {
              "@id": "run:sourceinfo/7",
              "@type": "sdtl:SourceInformation",
              "sdtl:originalSourceText": "temps = temps.assign(Kelvin=(temps.Celsius + 273))"
          }
        },
        {
          "@id": "run:save/1",
          "@type": "sdtl:Save",
          "sdtl:FileName": "df_updated.csv",
          "sdtl:FileFormat": "csv",
          "stdl:ProducesDataframe": {"@id": "run:dataframe/4"},
          "sdtl:SourceInformation": {
            "@id": "run:sourceinfo/8",
            "@type": "sdtl:SourceInformation",
            "sdtl:originalSourceText": "df.to_csv('outputs/df_updated.csv', index=False)"
          }
        },
        {
          "@id": "run:save/2",
          "@type": "sdtl:Save",
          "sdtl:FileName": "temps_updated.csv",
          "sdtl:FileFormat": "csv",
          "stdl:ProducesDataframe": {"@id": "run:dataframe/7"},
          "sdtl:SourceInformation": {
            "@id": "run:sourceinfo/9",
            "@type": "sdtl:SourceInformation",
            "sdtl:originalSourceText": "temps.to_csv('outputs/temps_updated.csv', index=False)"
          }
        }
      ]
    }
  ]
}
